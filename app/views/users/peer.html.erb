<h1>
  <%= @user.og_name %>
</h1>

<h2>Friends' Pinged Tasks</h2>

<ul class="nav nav-pills nav-fill">
  <li class="nav-item">
    <%= link_to "My Tasks", my_tasks_path(@user.username), class: "nav-link" %>
  </li>
  <li class="nav-item">
    <%= link_to "Friends' Pinged Tasks", peer_path(@user.username), class: "nav-link" %>
  </li>
  <li class="nav-item">
    <%= link_to "Friends List", user_friends_path(@user.username), class: "nav-link" %>
  </li>
</ul>

<% current_owner = nil %>
<% tasks_by_owner = @user.peer_tasks.order(owner_id: :asc, due_date: :asc, due_time: :asc).group_by(&:owner) %>
<% tasks_by_owner.each do |owner, tasks| %>
  <div class="row">
    <% tasks.in_groups_of(3, false).each do |tasks_group| %>
      <% tasks_group.compact.each do |task| %>
        <% if current_owner != task.owner %>
          <% current_owner = task.owner %>
          <div class="col-md-12">
            <% if task.owner.og_name.present? %>
              <h3><%= task.owner.og_name %>'s Tasks</h3>
            <% else %>
              <h3><%= task.owner.username %>'s Tasks</h3>
            <% end %>
          </div>
        <% end %>
        <div class="col-md-4">
          <%= render "tasks/task_list", task: task %>
        </div>
      <% end %>
    <% end %>
  </div>
<% end %>


<!-- Old Styling -->
<%# current_owner = nil %>
<%# @user.peer_tasks.each do |task| %>
  <%# if current_owner != task.owner %>
    <%# current_owner = task.owner %>
      <%# if task.owner.og_name != nil %>
<!--          <h3><%#= task.owner.og_name %>'s Tasks</h3>-->
        <%# else %>
<!--          <h3><%#= task.owner.username %>'s Tasks</h3>-->
        <%# end %>
  <%# end %>
  <%#= render "tasks/task_list", task: task %>
<%# end %>
